A rewrite of the ruby inject method.
